---
import '../styles/process.css';

export interface Props {
  className?: string;
}

const { className = "" } = Astro.props;

// Les Ã©tapes du processus de brassage - CORRIGÃ‰
const brewingSteps = [
  {
    id: 'concassage',
    number: '01',
    title: 'Concassage',
    description: 'Broyage dÃ©licat du malt pour libÃ©rer les enzymes tout en prÃ©servant les enveloppes.',
    duration: '15 min',
    temperature: null, // PAS DE TEMPÃ‰RATURE POUR LE CONCASSAGE
    icon: 'ğŸŒ¾'
  },
  {
    id: 'empatage',
    number: '02', 
    title: 'EmpÃ¢tage',
    description: 'MÃ©lange du malt concassÃ© avec l\'eau chaude pour convertir l\'amidon en sucres fermentescibles.',
    duration: '60-90 min',
    temperature: '62-68Â°C',
    icon: 'ğŸŒ¡ï¸'
  },
  {
    id: 'filtration',
    number: '03',
    title: 'Filtration',
    description: 'SÃ©paration du moÃ»t sucrÃ© des drÃªches Ã  travers le fond filtrant du systÃ¨me Grainfather.',
    duration: '45 min',
    temperature: '75-78Â°C',
    icon: 'ğŸ’§'
  },
  {
    id: 'ebullition',
    number: '04',
    title: 'Ã‰bullition',
    description: 'StÃ©rilisation du moÃ»t et ajout progressif des houblons pour l\'amertume et les arÃ´mes.',
    duration: '60-90 min',
    temperature: '100Â°C',
    icon: 'â™¨ï¸'
  },
  {
    id: 'refroidissement',
    number: '05',
    title: 'Refroidissement',
    description: 'Abaissement rapide de la tempÃ©rature pour prÃ©parer l\'ensemencement en levures.',
    duration: '30 min',
    temperature: '20Â°C',
    icon: 'â„ï¸'
  },
  {
    id: 'fermentation',
    number: '06',
    title: 'Fermentation',
    description: 'Transformation des sucres en alcool et COâ‚‚ par les levures dans nos fermenteurs coniques.',
    duration: '5-14 jours',
    temperature: '18-22Â°C',
    icon: 'ğŸ§ª'
  },
  {
    id: 'conditionnement',
    number: '07',
    title: 'Conditionnement',
    description: 'Mise en bouteille ou fÃ»t avec ajustement final de la carbonation et maturation.',
    duration: '2-4 semaines',
    temperature: '12-16Â°C',
    icon: 'ğŸº'
  }
];
---

<section id="process" class={`process-section ${className}`} aria-labelledby="process-title">
  <div class="process-container">
    
    <div class="process-header">
      <h2 id="process-title" class="process-title">Notre Processus</h2>
      <p class="process-subtitle">
        Du grain Ã  la biÃ¨re, dÃ©couvrez les 7 Ã©tapes clÃ©s de notre mÃ©thode artisanale 
        avec un contrÃ´le prÃ©cis Ã  chaque moment.
      </p>
    </div>

    <div class="process-timeline">
      {brewingSteps.map((step, index) => (
        <article 
          class="process-step"
          data-step={step.number}
          style={`--step-index: ${index}`}
        >
          <div class="step-number">
            <span class="number-text">{step.number}</span>
          </div>
          
          <div class="step-content">
            <div class="step-icon">{step.icon}</div>
            <h3 class="step-title">{step.title}</h3>
            <p class="step-description">{step.description}</p>
            
            <div class="step-details">
              <div class="detail-item">
                <span class="detail-label">DurÃ©e</span>
                <span class="detail-value">{step.duration}</span>
              </div>
              
              <!-- TEMPÃ‰RATURE SEULEMENT SI PERTINENTE -->
              {step.temperature && (
                <div class="detail-item">
                  <span class="detail-label">TempÃ©rature</span>
                  <span class="detail-value">{step.temperature}</span>
                </div>
              )}
            </div>
          </div>
        </article>
      ))}
    </div>

    <!-- Reste du code inchangÃ© -->
    <div class="process-info">
      <div class="info-grid">
        <div class="info-card">
          <h3>ğŸ¯ PrÃ©cision</h3>
          <p>ContrÃ´le PID Ã  Â±0.5Â°C pour une qualitÃ© constante et reproductible.</p>
        </div>
        <div class="info-card">
          <h3>âš¡ EfficacitÃ©</h3>
          <p>SystÃ¨me Grainfather optimisÃ© pour un rendement maximal et un nettoyage facile.</p>
        </div>
        <div class="info-card">
          <h3>ğŸ”¬ QualitÃ©</h3>
          <p>Analyses et dÃ©gustations Ã  chaque Ã©tape pour garantir l'excellence du produit final.</p>
        </div>
      </div>
    </div>

    <div class="process-cta">
      <h3>Envie de biÃ¨re ?</h3>
      <p>Contactez-nous pour parler de vos envies et de nos crÃ©ations</p>
      <a href="#contact" class="process-cta-button">
        <span>Nous contacter</span>
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <path d="M8 1l7 7-7 7M15 8H1" stroke="currentColor" stroke-width="2"/>
        </svg>
      </a>
    </div>

  </div>
</section>

<script>
  // Script inchangÃ©
  document.addEventListener('DOMContentLoaded', () => {
    const steps = document.querySelectorAll('.process-step');
    
    const observerOptions = {
      threshold: 0.2,
      rootMargin: '0px 0px -50px 0px'
    };
    
    const stepObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('step-visible');
          
          const details = entry.target.querySelectorAll('.detail-item');
          details.forEach((detail, index) => {
            setTimeout(() => {
              detail.classList.add('detail-visible');
            }, index * 100);
          });
        }
      });
    }, observerOptions);
    
    steps.forEach(step => stepObserver.observe(step));
    
    steps.forEach(step => {
      step.addEventListener('mouseenter', () => {
        step.classList.add('step-hovered');
      });
      
      step.addEventListener('mouseleave', () => {
        step.classList.remove('step-hovered');
      });
    });
    
    document.querySelector('.process-cta-button')?.addEventListener('click', (e) => {
      e.preventDefault();
      const contact = document.querySelector('#contact');
      if (contact) {
        contact.scrollIntoView({ behavior: 'smooth' });
      }
    });
  });
</script>
